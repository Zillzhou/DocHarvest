# é¡¹ç›®æ¶æ„æ–‡æ¡£

## ğŸ“‹ ç›®å½•
- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
- [æ•°æ®æµç¨‹](#æ•°æ®æµç¨‹)
- [ç±»è®¾è®¡](#ç±»è®¾è®¡)
- [é…ç½®ç®¡ç†](#é…ç½®ç®¡ç†)

---

## ğŸ“– é¡¹ç›®æ¦‚è¿°

**DocHarvest** æ˜¯ä¸€ä¸ªåŸºäº Python + PyQt5 çš„æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œç”¨äºä»é£ä¹¦åˆ†äº«é“¾æ¥ä¸­è·å–æ–‡æ¡£å†…å®¹å¹¶å¯¼å‡ºä¸º Markdown æ–‡ä»¶ã€‚

### ä¸»è¦åŠŸèƒ½
- ğŸ¨ **å›¾å½¢ç•Œé¢**ï¼šåŸºäº PyQt5 çš„ç°ä»£åŒ– UI
- ğŸ“„ **å•æ–‡æ¡£çˆ¬å–**ï¼šæ”¯æŒå•ä¸ªé£ä¹¦æ–‡æ¡£çš„ä¸‹è½½å’Œè½¬æ¢
- ğŸ“š **Wikiæ‰¹é‡çˆ¬å–**ï¼šé€’å½’çˆ¬å–æ•´ä¸ª Wiki ç›®å½•æ ‘
- ğŸ” **OAuthè®¤è¯**ï¼šä½¿ç”¨é£ä¹¦å®˜æ–¹ API è®¤è¯
- ğŸ“ **Markdownå¯¼å‡º**ï¼šå°†æ–‡æ¡£å†…å®¹è½¬æ¢ä¸ºæ ‡å‡† Markdown æ ¼å¼

---

## ğŸ›  æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.9+ | ä¸»è¦å¼€å‘è¯­è¨€ |
| PyQt5 | 5.15.9+ | GUIæ¡†æ¶ |
| requests | 2.31.0+ | HTTPè¯·æ±‚åº“ |
| PyInstaller | 6.10.0+ | æ‰“åŒ…å·¥å…· |

---

## ğŸ“ ç›®å½•ç»“æ„

```
DocHarvest/
â”œâ”€â”€ main.py                    # ğŸš€ ç¨‹åºå…¥å£
â”œâ”€â”€ gui.py                     # ğŸ¨ GUIç•Œé¢å’Œäº‹ä»¶å¤„ç†
â”œâ”€â”€ feishu_api.py              # ğŸ”Œ é£ä¹¦APIå°è£…
â”œâ”€â”€ wiki_crawler.py            # ğŸŒ² Wikié€’å½’çˆ¬å–é€»è¾‘
â”œâ”€â”€ markdown_converter.py      # ğŸ“ Markdownæ ¼å¼è½¬æ¢
â”œâ”€â”€ __init__.py               # ğŸ“¦ åŒ…åˆå§‹åŒ–
â”‚
â”œâ”€â”€ config.json               # âš™ï¸ é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ requirements.txt          # ğŸ“‹ Pythonä¾èµ–
â”‚
â”œâ”€â”€ build.spec                # ğŸ“¦ PyInstalleré…ç½®
â”œâ”€â”€ build.bat                 # ğŸªŸ Windowsæ‰“åŒ…è„šæœ¬
â”œâ”€â”€ build.sh                  # ğŸ§ Linux/Macæ‰“åŒ…è„šæœ¬
â”œâ”€â”€ install.bat               # ğŸ“¥ ä¾èµ–å®‰è£…è„šæœ¬
â”œâ”€â”€ run.bat                   # â–¶ï¸ å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ README.md                 # ğŸ“– é¡¹ç›®è¯´æ˜
â”œâ”€â”€ CHANGELOG.md              # ğŸ“ æ›´æ–°æ—¥å¿—
â”œâ”€â”€ LICENSE                   # âš–ï¸ MITè®¸å¯è¯
â”œâ”€â”€ .gitignore               # ğŸš« Gitå¿½ç•¥é…ç½®
â”‚
â”œâ”€â”€ logs/                     # ğŸ“‹ è¿è¡Œæ—¥å¿—ç›®å½•
â”‚   â””â”€â”€ feishu_crawler_YYYYMMDD.log
â”‚
â””â”€â”€ dist/                     # ğŸ“¦ æ‰“åŒ…è¾“å‡ºç›®å½•
    â””â”€â”€ é£ä¹¦æ–‡æ¡£çˆ¬å–å·¥å…·.exe
```

---

## ğŸ§© æ ¸å¿ƒæ¨¡å—

### 1ï¸âƒ£ `main.py` - ç¨‹åºå…¥å£

**èŒè´£**ï¼šç¨‹åºå¯åŠ¨å’Œåˆå§‹åŒ–

```python
main()
  â”œâ”€â”€ è®¾ç½®åº”ç”¨è·¯å¾„ï¼ˆæ”¯æŒæ‰“åŒ…åè¿è¡Œï¼‰
  â”œâ”€â”€ å¯¼å…¥GUIæ¨¡å—
  â””â”€â”€ å¯åŠ¨ä¸»çª—å£
```

**å…³é”®åŠŸèƒ½**ï¼š
- å¤„ç†æ‰“åŒ…åçš„è·¯å¾„é—®é¢˜ï¼ˆPyInstallerå…¼å®¹ï¼‰
- å¼‚å¸¸æ•è·å’Œé”™è¯¯æç¤º

---

### 2ï¸âƒ£ `gui.py` - å›¾å½¢ç•Œé¢

**èŒè´£**ï¼šç”¨æˆ·ç•Œé¢å’Œäº¤äº’é€»è¾‘

#### æ ¸å¿ƒç±»ï¼š

##### `MainWindow` - ä¸»çª—å£ç±»
```python
MainWindow(QMainWindow)
  â”œâ”€â”€ init_ui()           # åˆå§‹åŒ–ç•Œé¢
  â”œâ”€â”€ load_config()       # åŠ è½½é…ç½®
  â”œâ”€â”€ save_config()       # ä¿å­˜é…ç½®
  â”œâ”€â”€ start_crawl()       # å¼€å§‹çˆ¬å–
  â””â”€â”€ on_xxx()           # å„ç§äº‹ä»¶å¤„ç†
```

##### `WorkerThread` - å•æ–‡æ¡£çˆ¬å–çº¿ç¨‹
```python
WorkerThread(QThread)
  â”œâ”€â”€ run()              # æ‰§è¡Œçˆ¬å–ä»»åŠ¡
  â”œâ”€â”€ progress(int)      # è¿›åº¦ä¿¡å·
  â”œâ”€â”€ log_message(str)   # æ—¥å¿—ä¿¡å·
  â”œâ”€â”€ finished(bool, str)# å®Œæˆä¿¡å·
  â””â”€â”€ error(str)         # é”™è¯¯ä¿¡å·
```

##### `WikiWorkerThread` - Wikiæ‰¹é‡çˆ¬å–çº¿ç¨‹
```python
WikiWorkerThread(QThread)
  â”œâ”€â”€ run()              # æ‰§è¡ŒWikiçˆ¬å–
  â”œâ”€â”€ progress(int)      # è¿›åº¦ä¿¡å·
  â”œâ”€â”€ log_message(str)   # æ—¥å¿—ä¿¡å·
  â””â”€â”€ finished(bool, str)# å®Œæˆä¿¡å·
```

**ç•Œé¢å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“„ é£ä¹¦æ–‡æ¡£çˆ¬å–å·¥å…·                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš™ï¸ é…ç½®ä¿¡æ¯                            â”‚
â”‚    App ID:     [________________]       â”‚
â”‚    App Secret: [****************]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”— æ–‡æ¡£é“¾æ¥                            â”‚
â”‚    [è¯·ç²˜è´´é£ä¹¦æ–‡æ¡£åˆ†äº«é“¾æ¥...]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‚ çˆ¬å–æ¨¡å¼                            â”‚
â”‚    âšª å•æ–‡æ¡£çˆ¬å–  âšª Wikiæ‰¹é‡çˆ¬å–       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¾ ä¿å­˜è·¯å¾„                            â”‚
â”‚    [C:\Users\xxx\Desktop] [æµè§ˆ...]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [è¿›åº¦æ¡: â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘ 50%]              â”‚
â”‚  [ğŸš€ å¼€å§‹çˆ¬å–]                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ è¿è¡Œæ—¥å¿—                            â”‚
â”‚    [10:30:25] ğŸš€ åˆå§‹åŒ–é£ä¹¦APIå®¢æˆ·ç«¯... â”‚
â”‚    [10:30:26] ğŸ”‘ æ­£åœ¨è·å–access_token...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3ï¸âƒ£ `feishu_api.py` - é£ä¹¦APIå°è£…

**èŒè´£**ï¼šä¸é£ä¹¦å¼€æ”¾å¹³å°APIäº¤äº’

#### æ ¸å¿ƒç±»ï¼š

```python
FeishuAPI
  â”œâ”€â”€ __init__(app_id, app_secret)
  â”‚
  â”œâ”€â”€ get_tenant_access_token()          # è·å–è®¿é—®ä»¤ç‰Œ
  â”œâ”€â”€ get_document_metadata(doc_id)      # è·å–æ–‡æ¡£å…ƒæ•°æ®
  â”œâ”€â”€ get_document_content(doc_id)       # è·å–æ–‡æ¡£å†…å®¹
  â”œâ”€â”€ extract_document_id(url)           # ä»URLæå–æ–‡æ¡£ID
  â”‚
  â”œâ”€â”€ get_wiki_node_info(token)          # è·å–WikièŠ‚ç‚¹ä¿¡æ¯
  â”œâ”€â”€ get_wiki_children(space_id, parent_id) # è·å–Wikiå­èŠ‚ç‚¹åˆ—è¡¨
  â”‚
  â””â”€â”€ _make_request()                    # é€šç”¨HTTPè¯·æ±‚æ–¹æ³•
```

**æ”¯æŒçš„APIç«¯ç‚¹**ï¼š
- `POST /open-apis/auth/v3/tenant_access_token/internal` - è·å–token
- `GET /open-apis/docx/v1/documents/{document_id}` - è·å–æ–‡æ¡£å…ƒæ•°æ®
- `GET /open-apis/docx/v1/documents/{document_id}/raw_content` - è·å–æ–‡æ¡£å†…å®¹
- `GET /open-apis/wiki/v2/spaces/{space_id}/nodes/{node_id}` - è·å–WikièŠ‚ç‚¹ä¿¡æ¯
- `GET /open-apis/wiki/v2/spaces/{space_id}/nodes/{node_id}/children` - è·å–å­èŠ‚ç‚¹

---

### 4ï¸âƒ£ `wiki_crawler.py` - Wikiæ‰¹é‡çˆ¬å–

**èŒè´£**ï¼šé€’å½’çˆ¬å–Wikiç›®å½•æ ‘

#### æ ¸å¿ƒç±»ï¼š

```python
WikiCrawler
  â”œâ”€â”€ __init__(api, save_path)
  â”œâ”€â”€ crawl_wiki(wiki_url)               # çˆ¬å–Wikiæ ¹èŠ‚ç‚¹
  â”œâ”€â”€ _crawl_node(space_id, node_id, current_path, depth) # é€’å½’çˆ¬å–èŠ‚ç‚¹
  â”œâ”€â”€ _get_children(space_id, parent_id) # è·å–å­èŠ‚ç‚¹åˆ—è¡¨
  â””â”€â”€ _save_document(doc_id, title, save_path) # ä¿å­˜å•ä¸ªæ–‡æ¡£
```

**çˆ¬å–æµç¨‹**ï¼š
```
1. è§£æWikié“¾æ¥ â†’ æå–space_idå’Œnode_id
2. è·å–æ ¹èŠ‚ç‚¹ä¿¡æ¯
3. é€’å½’éå†ï¼š
   â”œâ”€â”€ è·å–å½“å‰èŠ‚ç‚¹çš„æ–‡æ¡£å†…å®¹
   â”œâ”€â”€ ä¿å­˜ä¸ºMarkdownæ–‡ä»¶
   â”œâ”€â”€ è·å–å­èŠ‚ç‚¹åˆ—è¡¨
   â””â”€â”€ å¯¹æ¯ä¸ªå­èŠ‚ç‚¹é€’å½’æ‰§è¡Œæ­¥éª¤3
4. ä¿ç•™ç›®å½•å±‚çº§ç»“æ„
```

**ç›®å½•ç»“æ„ç¤ºä¾‹**ï¼š
```
ä¿å­˜è·¯å¾„/
â”œâ”€â”€ Wikiæ ¹èŠ‚ç‚¹.md
â”œâ”€â”€ å­èŠ‚ç‚¹1/
â”‚   â”œâ”€â”€ å­èŠ‚ç‚¹1.md
â”‚   â””â”€â”€ å­™èŠ‚ç‚¹1.md
â””â”€â”€ å­èŠ‚ç‚¹2/
    â”œâ”€â”€ å­èŠ‚ç‚¹2.md
    â””â”€â”€ å­™èŠ‚ç‚¹2.md
```

---

### 5ï¸âƒ£ `markdown_converter.py` - Markdownè½¬æ¢

**èŒè´£**ï¼šå°†é£ä¹¦æ–‡æ¡£å†…å®¹è½¬æ¢ä¸ºMarkdownæ ¼å¼

#### æ ¸å¿ƒç±»ï¼š

```python
MarkdownConverter
  â”œâ”€â”€ convert(doc_content, doc_metadata) # è½¬æ¢æ–‡æ¡£
  â”œâ”€â”€ _format_content(content)           # æ ¼å¼åŒ–å†…å®¹
  â”œâ”€â”€ _clean_text(text)                  # æ¸…ç†æ–‡æœ¬
  â””â”€â”€ _format_lists(content)             # æ ¼å¼åŒ–åˆ—è¡¨
```

**è½¬æ¢è§„åˆ™**ï¼š
- æ·»åŠ æ–‡æ¡£æ ‡é¢˜ï¼ˆ# æ ‡é¢˜ï¼‰
- ä¿ç•™æ®µè½ç»“æ„
- æ ¼å¼åŒ–åˆ—è¡¨ï¼ˆæœ‰åº/æ— åºï¼‰
- æ¸…ç†å¤šä½™ç©ºç™½å­—ç¬¦
- ä¿ç•™åŸºæœ¬æ ¼å¼æ ‡è®°

---

## ğŸ”„ æ•°æ®æµç¨‹

### å•æ–‡æ¡£çˆ¬å–æµç¨‹

```
ç”¨æˆ·æ“ä½œ
  â”‚
  â”œâ”€â†’ å¡«å†™é…ç½®ï¼ˆApp ID, App Secretï¼‰
  â”‚
  â”œâ”€â†’ ç²˜è´´æ–‡æ¡£é“¾æ¥
  â”‚
  â”œâ”€â†’ ç‚¹å‡»"å¼€å§‹çˆ¬å–"
  â”‚
  â†“
MainWindow
  â”‚
  â”œâ”€â†’ åˆ›å»º WorkerThread
  â”‚
  â†“
WorkerThread.run()
  â”‚
  â”œâ”€â†’ 1. åˆå§‹åŒ– FeishuAPI
  â”‚     â””â”€â†’ get_tenant_access_token()
  â”‚
  â”œâ”€â†’ 2. æå–æ–‡æ¡£ID
  â”‚     â””â”€â†’ extract_document_id(url)
  â”‚
  â”œâ”€â†’ 3. è·å–æ–‡æ¡£å…ƒæ•°æ®
  â”‚     â””â”€â†’ get_document_metadata(doc_id)
  â”‚
  â”œâ”€â†’ 4. è·å–æ–‡æ¡£å†…å®¹
  â”‚     â””â”€â†’ get_document_content(doc_id)
  â”‚
  â”œâ”€â†’ 5. è½¬æ¢ä¸ºMarkdown
  â”‚     â””â”€â†’ MarkdownConverter.convert()
  â”‚
  â””â”€â†’ 6. ä¿å­˜æ–‡ä»¶
        â””â”€â†’ å†™å…¥ .md æ–‡ä»¶
  â”‚
  â†“
æ˜¾ç¤ºå®Œæˆæ¶ˆæ¯
```

### Wikiæ‰¹é‡çˆ¬å–æµç¨‹

```
ç”¨æˆ·æ“ä½œ
  â”‚
  â”œâ”€â†’ é€‰æ‹©"Wikiæ‰¹é‡çˆ¬å–"æ¨¡å¼
  â”‚
  â”œâ”€â†’ ç²˜è´´Wikié“¾æ¥
  â”‚
  â”œâ”€â†’ ç‚¹å‡»"å¼€å§‹çˆ¬å–"
  â”‚
  â†“
MainWindow
  â”‚
  â”œâ”€â†’ åˆ›å»º WikiWorkerThread
  â”‚
  â†“
WikiWorkerThread.run()
  â”‚
  â”œâ”€â†’ åˆå§‹åŒ– WikiCrawler
  â”‚
  â”œâ”€â†’ WikiCrawler.crawl_wiki(wiki_url)
  â”‚     â”‚
  â”‚     â”œâ”€â†’ è§£æWikié“¾æ¥
  â”‚     â”‚
  â”‚     â””â”€â†’ _crawl_node(space_id, node_id, path, depth)
  â”‚           â”‚
  â”‚           â”œâ”€â†’ è·å–èŠ‚ç‚¹ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€ç±»å‹ï¼‰
  â”‚           â”‚
  â”‚           â”œâ”€â†’ å¦‚æœæ˜¯æ–‡æ¡£ï¼š
  â”‚           â”‚     â”œâ”€â†’ FeishuAPI.get_document_content()
  â”‚           â”‚     â”œâ”€â†’ MarkdownConverter.convert()
  â”‚           â”‚     â””â”€â†’ ä¿å­˜æ–‡ä»¶
  â”‚           â”‚
  â”‚           â”œâ”€â†’ è·å–å­èŠ‚ç‚¹åˆ—è¡¨
  â”‚           â”‚     â””â”€â†’ _get_children(space_id, node_id)
  â”‚           â”‚
  â”‚           â””â”€â†’ é€’å½’çˆ¬å–æ¯ä¸ªå­èŠ‚ç‚¹
  â”‚                 â””â”€â†’ _crawl_node(...)  # é€’å½’è°ƒç”¨
  â”‚
  â””â”€â†’ å®Œæˆ
  â”‚
  â†“
æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼ˆæˆåŠŸ/å¤±è´¥æ•°é‡ï¼‰
```

---

## ğŸ— ç±»è®¾è®¡

### ç±»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MainWindow â”‚
â”‚  (QMainWindow)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚ åˆ›å»º
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
        â†“             â†“             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚WorkerThread  â”‚ â”‚BatchWorker   â”‚ â”‚WikiWorker    â”‚
â”‚  (QThread)   â”‚ â”‚Thread        â”‚ â”‚Thread        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  (QThread)   â”‚ â”‚  (QThread)   â”‚
       â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚                â”‚
       â”‚ ä½¿ç”¨           â”‚ ä½¿ç”¨           â”‚ ä½¿ç”¨
       â†“                â†“                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FeishuAPI                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ - app_id: str                        â”‚   â”‚
â”‚  â”‚ - app_secret: str                    â”‚   â”‚
â”‚  â”‚ - access_token: str                  â”‚   â”‚
â”‚  â”‚ - base_url: str                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ + get_tenant_access_token()          â”‚   â”‚
â”‚  â”‚ + get_document_metadata()            â”‚   â”‚
â”‚  â”‚ + get_document_content()             â”‚   â”‚
â”‚  â”‚ + extract_document_id()              â”‚   â”‚
â”‚  â”‚ + get_wiki_node_info()               â”‚   â”‚
â”‚  â”‚ + get_wiki_children()                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ ä½¿ç”¨
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MarkdownConverter                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ + convert()                          â”‚   â”‚
â”‚  â”‚ + _format_content()                  â”‚   â”‚
â”‚  â”‚ + _clean_text()                      â”‚   â”‚
â”‚  â”‚ + _format_lists()                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        WikiCrawler               â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
        â”‚  â”‚ - api: FeishuAPI         â”‚    â”‚
        â”‚  â”‚ - converter: Converter   â”‚    â”‚
        â”‚  â”‚ - save_path: str         â”‚    â”‚
        â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
        â”‚  â”‚ + crawl_wiki()           â”‚    â”‚
        â”‚  â”‚ + _crawl_node()          â”‚    â”‚
        â”‚  â”‚ + _get_children()        â”‚    â”‚
        â”‚  â”‚ + _save_document()       â”‚    â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ é…ç½®ç®¡ç†

### config.json ç»“æ„

```json
{
  "app_id": "cli_xxxxxxxxxxxxxxxx",       // é£ä¹¦åº”ç”¨ID
  "app_secret": "xxxxxxxxxxxxxxxx",       // é£ä¹¦åº”ç”¨å¯†é’¥
  "default_save_path": ""                 // é»˜è®¤ä¿å­˜è·¯å¾„ï¼ˆå¯é€‰ï¼‰
}
```

### é…ç½®åŠ è½½æµç¨‹

```
ç¨‹åºå¯åŠ¨
  â”œâ”€â†’ æ£€æŸ¥ config.json æ˜¯å¦å­˜åœ¨
  â”‚
  â”œâ”€â†’ å­˜åœ¨ï¼šè¯»å–é…ç½®
  â”‚     â””â”€â†’ å¡«å……åˆ°ç•Œé¢è¾“å…¥æ¡†
  â”‚
  â””â”€â†’ ä¸å­˜åœ¨ï¼šä½¿ç”¨é»˜è®¤å€¼
        â””â”€â†’ App ID: ""
        â””â”€â†’ App Secret: ""
        â””â”€â†’ Save Path: æ¡Œé¢è·¯å¾„
```

### é…ç½®ä¿å­˜æ—¶æœº

- ç”¨æˆ·ç‚¹å‡»"å¼€å§‹çˆ¬å–"æ—¶è‡ªåŠ¨ä¿å­˜
- ç¨‹åºå…³é—­æ—¶ä¿å­˜å½“å‰é…ç½®

---

## ğŸ” æƒé™è¦æ±‚

### é£ä¹¦åº”ç”¨éœ€è¦çš„æƒé™

| æƒé™èŒƒå›´ | æƒé™åç§° | ç”¨é€” |
|---------|---------|------|
| `docx:document:readonly` | æŸ¥çœ‹ã€è¯„è®ºå’Œå¯¼å‡ºæ–‡æ¡£ | è·å–æ–‡æ¡£å†…å®¹ |
| `docs:read` | æŸ¥çœ‹æ–‡æ¡£ | è¯»å–æ–‡æ¡£å…ƒæ•°æ® |
| `wiki:wiki:readonly` | æŸ¥çœ‹çŸ¥è¯†åº“ | Wikiæ‰¹é‡çˆ¬å– |

---

## ğŸ“ æ—¥å¿—ç³»ç»Ÿ

### æ—¥å¿—é…ç½®

```python
æ—¥å¿—çº§åˆ«: INFO
æ—¥å¿—æ ¼å¼: [æ—¶é—´] [çº§åˆ«] [æ¨¡å—] æ¶ˆæ¯
æ—¥å¿—æ–‡ä»¶: logs/feishu_crawler_YYYYMMDD.log
```

### æ—¥å¿—è®°å½•ç‚¹

- APIè¯·æ±‚å’Œå“åº”
- æ–‡æ¡£çˆ¬å–è¿›åº¦
- é”™è¯¯å’Œå¼‚å¸¸ä¿¡æ¯
- æ–‡ä»¶ä¿å­˜æ“ä½œ

---

## ğŸ”¨ æ‰“åŒ…éƒ¨ç½²

### PyInstaller é…ç½®ï¼ˆbuild.specï¼‰

```python
å…³é”®é…ç½®ï¼š
- å•æ–‡ä»¶æ¨¡å¼ï¼ˆonefile=Trueï¼‰
- åŒ…å«é…ç½®æ–‡ä»¶
- éšè—æ§åˆ¶å°çª—å£ï¼ˆconsole=Falseï¼‰
- è‡ªå®šä¹‰å›¾æ ‡
```

### æ‰“åŒ…å‘½ä»¤

```bash
# Windows
build.bat

# Linux/Mac
./build.sh
```

### è¾“å‡ºæ–‡ä»¶

```
dist/
â””â”€â”€ é£ä¹¦æ–‡æ¡£çˆ¬å–å·¥å…·.exe  # Windowså¯æ‰§è¡Œæ–‡ä»¶
```

---

## ğŸš€ æ‰©å±•ç‚¹

### å¦‚ä½•æ·»åŠ æ–°çš„æ–‡æ¡£ç±»å‹æ”¯æŒ

1. åœ¨ `FeishuAPI` ä¸­æ·»åŠ æ–°çš„APIæ–¹æ³•
2. åœ¨ `MarkdownConverter` ä¸­æ·»åŠ æ–°çš„è½¬æ¢é€»è¾‘
3. åœ¨ `MainWindow` ä¸­æ·»åŠ UIæ§ä»¶ï¼ˆå¦‚éœ€è¦ï¼‰

### å¦‚ä½•æ·»åŠ æ–°çš„å¯¼å‡ºæ ¼å¼

1. åˆ›å»ºæ–°çš„è½¬æ¢å™¨ç±»ï¼ˆå¦‚ `HTMLConverter`ï¼‰
2. åœ¨ç•Œé¢æ·»åŠ æ ¼å¼é€‰æ‹©é€‰é¡¹
3. åœ¨ Worker çº¿ç¨‹ä¸­è°ƒç”¨å¯¹åº”çš„è½¬æ¢å™¨

---

## ğŸ“Š æ€§èƒ½è€ƒè™‘

### å¤šçº¿ç¨‹è®¾è®¡

- GUIä¸»çº¿ç¨‹ï¼šè´Ÿè´£ç•Œé¢å“åº”
- Workerçº¿ç¨‹ï¼šæ‰§è¡Œè€—æ—¶çš„ç½‘ç»œè¯·æ±‚å’Œæ–‡ä»¶æ“ä½œ
- é€šè¿‡ä¿¡å·ï¼ˆSignalsï¼‰å®ç°çº¿ç¨‹é—´é€šä¿¡

### é”™è¯¯å¤„ç†

- ç½‘ç»œè¯·æ±‚è¶…æ—¶ï¼ˆ30ç§’ï¼‰
- APIé”™è¯¯é‡è¯•æœºåˆ¶
- å¼‚å¸¸æ•è·å’Œæ—¥å¿—è®°å½•

### èµ„æºç®¡ç†

- æ–‡ä»¶å†™å…¥æ—¶ä½¿ç”¨ç¼“å†²
- APIè¯·æ±‚æ·»åŠ å»¶è¿Ÿï¼Œé¿å…é¢‘ç¹è°ƒç”¨
- Wikiçˆ¬å–æ”¯æŒä¸­æ–­

---

## ğŸ” è°ƒè¯•æŠ€å·§

### å¼€å‘æ¨¡å¼è¿è¡Œ

```bash
python main.py
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/feishu_crawler_20241017.log

# Windows
Get-Content logs\feishu_crawler_20241017.log -Wait
```

### å¸¸è§é—®é¢˜æ’æŸ¥

1. **APIè°ƒç”¨å¤±è´¥**ï¼šæ£€æŸ¥æ—¥å¿—ä¸­çš„HTTPçŠ¶æ€ç 
2. **æ–‡æ¡£IDæå–å¤±è´¥**ï¼šæ£€æŸ¥URLæ ¼å¼æ˜¯å¦æ­£ç¡®
3. **æƒé™ä¸è¶³**ï¼šç¡®è®¤åº”ç”¨å·²æ·»åŠ ç›¸åº”æƒé™å¹¶å‘å¸ƒ

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [é£ä¹¦å¼€æ”¾å¹³å°æ–‡æ¡£](https://open.feishu.cn/document/home/index)
- [PyQt5å®˜æ–¹æ–‡æ¡£](https://doc.qt.io/qtforpython-5/)
- [Python Requestsæ–‡æ¡£](https://requests.readthedocs.io/)

---

**æœ€åæ›´æ–°**: 2024-10-17
**ç‰ˆæœ¬**: 1.0.0

